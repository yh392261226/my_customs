#!/usr/bin/env bash
### Desc: 定位别名源所在位置及对应的函数或命令内容

function _show_fzf_awesome_alias() {
    if [ "" != "$1" ] && [ "" != "$2" ]; then
        CCommand=$1
        CLocation=$2
        CSeprator="|" # 用于处理特殊字符而增加的分隔符

        TmpContent=$(cat $CLocation | sed 's/^ //g' | sed "s/^/${CSeprator}/" | grep -F "${CSeprator}${CCommand}=")

        # echo $CCommand
        # echo $CLocation
        # awesome_alias_file=
        awesome_alias_name=$CCommand
        awesome_alias_to=$(echo "$TmpContent" | sed -e "s/${CSeprator}${CCommand}=//g")
        awesome_alias_desc=""

        # echo "Alias Location    :"$awesome_alias_file
        echo "Alias Name        :⭆ "$CCommand
        echo "Alias To          :⭆ "$awesome_alias_to
        echo "Alias Description :⭆ " $awesome_alias_desc
        echo ""
        echo "Which Command:"
        echo "⇶⇶⇶⇶⇶⇶⇶⇶⇶⇶⇶⇶⇶⇶⇶⇶⇶⇶⇶⇶ "
        echo ""
        echo ""
        env which "$awesome_alias_to"
        echo ""
        if [ ! "$(echo $awesome_alias_to | grep -E '\.')" ]; then
            CommandLocation=$(find $MYRUNTIME/customs/my_shell -type f | xargs grep -E "(function ${awesome_alias_file})(.*?)[^(]*" | awk -F':' '{print $1}' | sort | uniq)
            if [ "" != "$CommandLocation" ]; then
                sed -n "/function ${awesome_alias_to}(/,/^}/p" $CommandLocation | /opt/homebrew/bin/bat --style="numbers,changes,header,grid" --theme="gruvbox-dark" --pager "less -RF" --map-syntax ".ignore:Git Ignore"
            fi
        fi
    fi
}

_show_fzf_awesome_alias $1 $2
