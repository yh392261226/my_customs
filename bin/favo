#!/usr/bin/env bash
########################################
## Desc: å›¾ç‰‡æ”¶è—ç®¡ç†è„šæœ¬ (ä¼˜åŒ–ç‰ˆ)
## Author: æ¨æµ©
########################################

# --------------------------
# ç¯å¢ƒé…ç½®
# --------------------------
MYRUNTIME=$(cat ${HOME}/.myruntime)
RUNTIME_DIR="${MYRUNTIME}/tools"
curmark=$(basename $(readlink $MYRUNTIME/pictures))
FAVO_MARK="${RUNTIME_DIR}/m_favorate_${curmark}"
FAVO_HTML="${RUNTIME_DIR}/m_favorate_${curmark}.html"
CURRENT_PIC="${RUNTIME_DIR}/current_picturename"
TMPFILE=/tmp/favo_tmp
DEFAULT_BROWSER="/Applications/Safari.app"
BACKUP_BROWSER="/Applications/Google Chrome.app"
THUMB_SIZE="40" # é»˜è®¤ç¼©ç•¥å›¾å°ºå¯¸

# --------------------------
# åˆå§‹åŒ–æ£€æŸ¥
# --------------------------
init_check() {
	[[ ! -d "${RUNTIME_DIR}" ]] && mkdir -p "${RUNTIME_DIR}"

	local required_commands=("trash" "fzf" "viu")
	for cmd in "${required_commands[@]}"; do
		if ! command -v "${cmd}" &>/dev/null; then
			echo "é”™è¯¯: ç¼ºå°‘ä¾èµ–å‘½ä»¤ ${cmd}"
			exit 1
		fi
	done

	[[ ! -f "${CURRENT_PIC}" ]] && touch "${CURRENT_PIC}"
	[[ ! -f "${FAVO_MARK}" ]] && touch "${FAVO_MARK}"
}

# --------------------------
# æ ¸å¿ƒåŠŸèƒ½
# --------------------------

# è·å–å½“å‰å›¾ç‰‡è·¯å¾„
get_current_pic() {
	[[ -f "${CURRENT_PIC}" ]] && cat "${CURRENT_PIC}" || echo ""
}

# æ˜¾ç¤ºç¼©ç•¥å›¾
show_thumbnail() {
	local img_path="${1:-$(get_current_pic)}"
	[[ -z "${img_path}" ]] && return 1

	viu --width "${THUMB_SIZE}" "${img_path}"
}

# æ·»åŠ æ”¶è—
add_favorite() {
	local target_pic="${1:-$(get_current_pic)}"
	[[ -z "${target_pic}" ]] && return 1

	if grep -qF "${target_pic}" "${FAVO_MARK}"; then
		echo "å›¾ç‰‡å·²å­˜åœ¨æ”¶è—!"
		return 1
	fi

	echo "${target_pic}" >>"${FAVO_MARK}" && sort -u "${FAVO_MARK}" -o "${FAVO_MARK}"
	echo "æˆåŠŸæ·»åŠ æ”¶è—!"
}

# åˆ é™¤æ”¶è—
remove_favorite() {
	local target_id="${1}"
	if [[ -z "${target_id}" ]]; then
		interactive_remove
	else
		remove_by_id "${target_id}"
	fi
}

interactive_remove() {
	local header="ğŸ–¼ï¸ å›¾ç‰‡æ”¶è— (å…± $(wc -l <"${FAVO_MARK}") å¼ )"
	local preview_cmd='viu --width 100 $(echo {} | awk -F"â”‚" "{print \$2}")'
	local selected=$(nl -w2 -s' â”‚ ' "${FAVO_MARK}" | fzf $FZF_CUSTOM_PARAMS --header="é€‰æ‹©è¦åˆ é™¤çš„å›¾ç‰‡ (æŒ‰ESCé€€å‡º)" +m \
		--delimiter='â”‚' \
		--border-label="â•¢ Favorate Images â•Ÿ" \
		--ghost="Type your search words â”ˆâ”‰ " \
		--preview-window="right,50%,border-left,<50(up,30%,border-bottom),nohidden,~3" \
		--bind "ctrl-d:execute(echo {} | awk -F'â”‚' '{print \$2}' | xargs trash)+abort" \
		--bind "ctrl-o:execute(echo {} | awk -F'â”‚' '{print \$2}' | xargs open -R)+abort" \
		--header "${header}" \
		--preview "${preview_cmd} ")
	[[ -z "${selected}" ]] && return
	selected=$(basename $(echo "$selected" | awk -F'â”‚' '{print $2}'))
	cat ${FAVO_MARK} | grep -v "$selected" >$TMPFILE
	[[ -f $TMPFILE ]] && rm -f ${FAVO_MARK} && mv $TMPFILE ${FAVO_MARK}
}

# --------------------------
# äº¤äº’å¼åˆ—è¡¨ (å¸¦é¢„è§ˆ)
# --------------------------
list_favorites() {
	[[ ! -s "${FAVO_MARK}" ]] && echo "æ”¶è—åˆ—è¡¨ä¸ºç©º" && return 1

	local header="ğŸ–¼ï¸ å›¾ç‰‡æ”¶è— (å…± $(wc -l <"${FAVO_MARK}") å¼ )"
	local preview_cmd='viu --width 100 $(echo {} | awk -F"â”‚" "{print \$2}")'

	# æ„å»ºå¸¦åºå·çš„åˆ—è¡¨
	local selected=$(nl -w2 -s' â”‚ ' "${FAVO_MARK}" |
		fzf $FZF_CUSTOM_PARAMS +m --delimiter='â”‚' \
			--border-label="â•¢ Favorate Images â•Ÿ" \
			--ghost="Type your search words â”ˆâ”‰ " \
			--preview-window="right,50%,border-left,<50(up,30%,border-bottom),nohidden,~3" \
			--preview "${preview_cmd} " \
			--header "${header}" \
			--reverse \
			--bind "ctrl-d:execute(echo {} | awk -F'â”‚' '{print \$2}' | xargs trash)+abort" \
			--bind "ctrl-o:execute(echo {} | awk -F'â”‚' '{print \$2}' | xargs open -R)+abort" \
			--bind="ctrl-u:become(${MYRUNTIME}/customs/bin/_actioner {2})" \
			--prompt="â¯ é€‰æ‹©å›¾ç‰‡ (CTRL+Dåˆ é™¤ CTRL+Oå®šä½) > " \
			--ansi)
	[[ -z "${selected}" ]] && return
	selected=$(echo "$selected" | awk -F'â”‚' '{print $2}')
	set_background $selected
}

generate_html() {
	[[ ! -s "${FAVO_MARK}" ]] && return 1

	cat <<HTML_HEAD >"${FAVO_HTML}"
<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>å›¾ç‰‡æ”¶è—</title>
  <style>
    .gallery {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 15px;
      padding: 20px;
    }
    .img-container {
      overflow: hidden;
      border-radius: 8px;
      transition: transform 0.3s ease;
    }
    img {
      width: 100%;
      height: 200px;
      object-fit: cover;
      transition: all 0.3s ease;
      cursor: zoom-in;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    img:hover {
      transform: scale(1.1);
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      z-index: 2;
    }
    body {
      background-color: #f5f5f5;
      margin: 0;
      font-family: Arial, sans-serif;
    }
    h1 {
      text-align: center;
      color: #333;
      padding: 20px;
    }
    .modal {
      display: none;
      position: fixed;
      z-index: 999;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.9);
      cursor: zoom-out;
    }
    .modal-content {
      position: absolute;
      top: 10%;
      left: 20%;
      right: 20%;
      bottom: 15%;
      max-width: 1200px;
      max-height: 675px;
      object-fit: contain;
      box-shadow: 0 0 30px rgba(255,255,255,0.2);
      border-radius: 4px;
      width: 900px;
      height: 506px;
    }
    .modal-buttons {
      position: absolute;
      bottom: 10px;
      width: 100%;
      text-align: center;
      padding: 10px 0;
    }
    .modal-btn {
      padding: 8px 20px;
      margin: 0 10px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
      transition: all 0.2s;
      min-width: 100px;
    }
    .detail-btn {
      background-color: #4CAF50;
      color: white;
    }
    .copy-btn {
      background-color: #2196F3;
      color: white;
    }
    .close-btn {
      background-color: #f44336;
      color: white;
    }
    .modal-btn:hover {
      opacity: 0.9;
      transform: translateY(-2px);
    }
    .toast {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background-color: rgba(0, 0, 0, 0.85);
      color: white;
      padding: 12px 24px;
      border-radius: 4px;
      z-index: 1000;
      display: none;
      font-size: 16px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      animation: fadeInOut 2.5s ease-in-out;
    }
    @keyframes fadeInOut {
      0% { opacity: 0; top: 10px; }
      15% { opacity: 1; top: 20px; }
      85% { opacity: 1; top: 20px; }
      100% { opacity: 0; top: 10px; }
    }
    .filename-display {
      position: absolute;
      bottom: 60px;
      left: 0;
      right: 0;
      text-align: center;
      color: #fff;
      font-size: 16px;
      padding: 5px;
      background: rgba(0,0,0,0.5);
      border-radius: 4px;
      margin: 0 20%;
    }
  </style>
  <script>
    function openModal(imgSrc, rawPath) {
      const modal = document.createElement('div');
      modal.className = 'modal';
      
      // æå–æ–‡ä»¶åç”¨äºæ˜¾ç¤º
      const fileName = rawPath.split('/').pop() || 'æœªå‘½åå›¾ç‰‡';
      
      modal.innerHTML = \`
        <img class="modal-content" src="\${imgSrc}" onclick="event.stopPropagation()">
        <div class="filename-display">\${fileName}</div>
        <div class="modal-buttons">
          <button class="modal-btn detail-btn" onclick="window.open('\${imgSrc}', '_blank'); event.stopPropagation()">æŸ¥çœ‹è¯¦æƒ…</button>
          <button class="modal-btn copy-btn" onclick="copyImageUrl('\${rawPath.replace(/'/g, "\\\\'")}'); event.stopPropagation()">å¤åˆ¶åœ°å€</button>
          <button class="modal-btn close-btn" onclick="closeModal(); event.stopPropagation()">å…³é—­</button>
        </div>
      \`;
      modal.onclick = closeModal;
      document.body.appendChild(modal);
      modal.style.display = "block";
      document.body.style.overflow = 'hidden'; // é˜²æ­¢èƒŒæ™¯æ»šåŠ¨
    }
    
    function closeModal() {
      const modal = document.querySelector('.modal');
      if(modal) {
        modal.remove();
        document.body.style.overflow = ''; // æ¢å¤æ»šåŠ¨
      }
    }
    
    // å¤åˆ¶å›¾ç‰‡åœ°å€åŠŸèƒ½
    function copyImageUrl(path) {
      // ä¼˜å…ˆä½¿ç”¨æ–°çš„ Clipboard API
      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(path)
          .then(() => showToast('âœ“ è·¯å¾„å·²å¤åˆ¶åˆ°å‰ªè´´æ¿'))
          .catch(err => {
            console.error('å¤åˆ¶å¤±è´¥:', err);
            showToast('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶');
          });
      } 
      // é™çº§æ–¹æ¡ˆï¼šä½¿ç”¨ä¼ ç»Ÿæ–¹æ³•
      else {
        const textArea = document.createElement('textarea');
        textArea.value = path;
        textArea.style.position = 'fixed';
        textArea.style.opacity = 0;
        document.body.appendChild(textArea);
        textArea.select();
        
        try {
          const successful = document.execCommand('copy');
          showToast(successful ? 'âœ“ è·¯å¾„å·²å¤åˆ¶åˆ°å‰ªè´´æ¿' : 'å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶');
        } catch (err) {
          showToast('å¤åˆ¶å¤±è´¥: ' + err);
        }
        document.body.removeChild(textArea);
      }
    }
    
    // æ˜¾ç¤ºæ“ä½œæç¤º
    function showToast(message) {
      // ç§»é™¤ç°æœ‰æç¤º
      const existingToast = document.querySelector('.toast');
      if (existingToast) existingToast.remove();
      
      // åˆ›å»ºæ–°æç¤º
      const toast = document.createElement('div');
      toast.className = 'toast';
      toast.textContent = message;
      document.body.appendChild(toast);
      
      // è‡ªåŠ¨ç§»é™¤æç¤º
      setTimeout(() => {
        if (toast.parentNode) {
          toast.parentNode.removeChild(toast);
        }
      }, 2500);
    }
    
    // æ”¯æŒESCé”®å…³é—­æ¨¡æ€æ¡†
    document.addEventListener('keydown', function(event) {
      if (event.key === 'Escape') {
        closeModal();
      }
    });
  </script>
</head>
<body>
  <h1>æˆ‘çš„å›¾ç‰‡æ”¶è— ($(wc -l <"${FAVO_MARK}"))</h1>
  <div class="gallery">
HTML_HEAD

	while IFS= read -r img; do
		if [ -f "$img" ]; then
			# å¤„ç†ç‰¹æ®Šå­—ç¬¦ï¼šHTMLè½¬ä¹‰
			html_safe_img=$(printf '%s' "$img" | sed 's/&/\&amp;/g; s/</\&lt;/g; s/>/\&gt;/g; s/"/\&quot;/g; s/'"'"'/\&#39;/g')
			
			# ç”Ÿæˆå¸¦åŸå§‹è·¯å¾„çš„è°ƒç”¨
			echo "<div class=\"img-container\"><img src=\"file://${html_safe_img}\" alt=\"${img##*/}\" onclick=\"openModal('file://${html_safe_img}', '${html_safe_img}')\"></div>" >>"${FAVO_HTML}"
		fi
	done <"${FAVO_MARK}"

	echo "</div></body></html>" >>"${FAVO_HTML}"
	open "${FAVO_HTML}" -a "${DEFAULT_BROWSER:-${BACKUP_BROWSER}}" --args --allow-file-access-from-files
}

# è®¾ç½®èƒŒæ™¯
set_background() {
	local img_path="${1}"
	[[ ! -f "${img_path}" ]] && return 1

	echo "${img_path}" >"${CURRENT_PIC}"
	osascript <<APPLESCRIPT
  tell application "iTerm"
    tell current window
      tell current session
        set background image to "${img_path}"
      end tell
    end tell
  end tell
APPLESCRIPT
}

# --------------------------
# è¾…åŠ©åŠŸèƒ½
# --------------------------

# éšæœºåˆ‡æ¢
random_pic() {
	local total=$(wc -l <"${FAVO_MARK}")
	[[ "${total}" -eq 0 ]] && return 1
	local rand_num=$((RANDOM % total))
	echo "Random Change Background Done ."
	set_background "$(sed -n "${rand_num}p" "${FAVO_MARK}")"
}

# æ–‡ä»¶å®šä½
locate_file() {
	open -R "$(get_current_pic)"
}

# æ¨¡ç³Šæœç´¢
fuzzy_search() {
	local keyword="${1}"
	[[ -z "${keyword}" ]] && read -p "è¾“å…¥æœç´¢å…³é”®è¯: " keyword
	[[ -z "${keyword}" ]] && return
	local header="ğŸ–¼ï¸ å›¾ç‰‡æ”¶è— (å…± $(wc -l <"${FAVO_MARK}") å¼ )"
	local preview_cmd='viu --width 100 $(echo {} | awk -F"â”‚" "{print \$2}")'
	local selected=$(nl -w2 -s' â”‚ ' "${FAVO_MARK}" | grep "${keyword}" | fzf $FZF_CUSTOM_PARAMS +m --delimiter='â”‚' \
		--border-label="â•¢ Favorate Images â•Ÿ" \
		--ghost="Type your search words â”ˆâ”‰ " \
		--preview-window="right,50%,border-left,<50(up,30%,border-bottom),nohidden,~3" \
		--preview "${preview_cmd} " \
		--header "${header}" \
		--reverse \
		--bind "ctrl-d:execute(echo {} | awk -F'â”‚' '{print \$2}' | xargs trash)+abort" \
		--bind "ctrl-o:execute(echo {} | awk -F'â”‚' '{print \$2}' | xargs open -R)+abort" \
		--prompt="â¯ é€‰æ‹©å›¾ç‰‡ (CTRL+Dåˆ é™¤ CTRL+Oå®šä½) > " \
		--ansi)
	[[ -z "${selected}" ]] && return
	selected=$(echo "$selected" | awk -F'â”‚' '{print $2}')
	# echo $selected; return
	set_background $selected
}

# å»é™¤ä¸å­˜åœ¨çš„æ–‡ä»¶
rebuild_favorite() {
	echo "Make sure your choice: y|Y|yes|YES/|n|N|no|NO"
	read choice
	if [ "$choice" = "yes" ] || [ "$choice" = "y" ] || [ "$choice" = "Y" ] || [ "$choice" = "YES" ]; then
		favolists=$(cat ${FAVO_MARK})
		favo_array[0]=''
		posit=0
		if [ -f $TMPFILE ]; then
			rm -f $TMPFILE
		fi
		for i in ${favolists[*]}; do
			if [ "$i" != "" ] && [ -f $i ]; then
				echo $i >>$TMPFILE
			fi
			((posit += 1))
		done

		if [ -f $TMPFILE ]; then
			mv $TMPFILE ${FAVO_MARK}
		fi
		if [ "$?" = "0" ]; then
			echo "Done ..."
			return 0
		else
			echo "Failure ..."
			return 1
		fi
	else
		return 1
	fi
}

# è¡¨æ ¼å½¢å¼å±•ç¤º
table_favorate() {
	# é…ç½®å‚æ•°
	local cols=5        # æ¯è¡Œæ˜¾ç¤ºåˆ—æ•°
	local max_width=300 # æœ€å¤§æ˜¾ç¤ºå®½åº¦ï¼ˆåƒç´ ï¼‰
	local char_width=6  # æ¯ä¸ªå­—ç¬¦çš„åƒç´ å®½åº¦ä¼°ç®—å€¼

	# è®¡ç®—å®é™…æ˜¾ç¤ºå®½åº¦
	local term_cols=$(tput cols)
	local max_term_width=$((term_cols * char_width - 20))
	local display_width=$((max_width < max_term_width ? max_width : max_term_width))

	# åˆå§‹åŒ–è¡Œç¼“å†²
	local count=0
	local -a line_buffer
	local -a name_buffer

	# éå†æ”¶è—æ–‡ä»¶
	while IFS= read -r file; do
		# éªŒè¯æ–‡ä»¶å­˜åœ¨æ€§
		[[ ! -f "$file" ]] && continue

		# è·å–æ–‡ä»¶åï¼ˆå¤„ç†ç‰¹æ®Šå­—ç¬¦ï¼‰
		local filename=$(basename "$file" | sed 's/[\"\\]//g')

		# ç”Ÿæˆå›¾ç‰‡è½¬ä¹‰åºåˆ—ï¼ˆå…¼å®¹macOS base64ï¼‰
		local img_data=$(base64 --encode "$file" 2>/dev/null || base64 "$file" | tr -d '\n')
		local filesize=$(wc -c <"$file" | tr -d ' ')

		# æ„å»ºè½¬ä¹‰åºåˆ—ï¼ˆå…³é”®ï¼šæœ«å°¾ä¸æ¢è¡Œï¼‰
		local esc_seq="\033]1337;File=name=${filename};size=${filesize};inline=1;width=${display_width}px;preserveAspectRatio=1:${img_data}\a"

		# å­˜å…¥è¡Œç¼“å†²
		line_buffer+=("$esc_seq")
		name_buffer+=("$filename")
		((count++))

		# æ•´è¡Œè¾“å‡ºï¼ˆå…³é”®ç‚¹1ï¼šåŒä¸€è¡Œå›¾ç‰‡è¿ç»­è¾“å‡ºï¼‰
		if ((count % cols == 0)); then
			# è¾“å‡ºå›¾ç‰‡è¡Œï¼ˆå…³é”®ç‚¹2ï¼š-neå‚æ•°+ä¸æ¢è¡Œï¼‰
			echo -ne "${line_buffer[@]}"

			# è¾“å‡ºæ–‡ä»¶åè¡Œï¼ˆå…³é”®ç‚¹3ï¼šç²¾ç¡®è®¡ç®—å ä½ï¼‰
			echo -en "\n\033[0m"
			local col_width=$((display_width / char_width + 2))
			printf "%-${col_width}s" "${name_buffer[@]}" |
				awk -v width=$col_width -v cols=$cols '
                    {
                        gsub(/ /, "  "); 
                        for(i=1; i<=cols; i++) {
                            printf "%-"width"s", substr($0, (i-1)*width+1, width)
                        }
                        print ""
                    }'
			echo

			# æ¸…ç©ºç¼“å†²
			line_buffer=()
			name_buffer=()
		fi
	done <"${FAVO_MARK}"

	# å¤„ç†å‰©ä½™å›¾ç‰‡
	if ((${#line_buffer[@]} > 0)); then
		echo -ne "${line_buffer[@]}"
		echo -en "\n\033[0m"
		local col_width=$((display_width / char_width + 2))
		printf "%-${col_width}s" "${name_buffer[@]}" |
			awk -v width=$col_width -v cols=${#line_buffer[@]} '
                {
                    gsub(/ /, "  "); 
                    for(i=1; i<=cols; i++) {
                        printf "%-"width"s", substr($0, (i-1)*width+1, width)
                    }
                    print ""
                }'
		echo
	fi
}
# ä½¿ç”¨ç¤ºä¾‹ï¼š
# imgtable *.jpg *.png

# --------------------------
# ä¸»ç¨‹åº
# --------------------------
main() {
	init_check

	case "${1}" in
	add | a) add_favorite "${2}" ;;
	remove | rm) remove_favorite "${2}" ;;
	list | l) list_favorites ;;
	html | h) generate_html ;;
	set) set_background "${2}" ;;
	random | r) random_pic ;;
	locate | lo) locate_file ;;
	search | s) fuzzy_search "${2}" ;;
	thumb | t) show_thumbnail "${2}" ;;
	rebuild | re) rebuild_favorite "${2}" ;;
	table | ta) table_favorate "${@}" ;;
	*)
		echo "â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -- - ï½¥
â”‚ ä½¿ç”¨æ–¹æ³•: ${0##*/} [command(å¯ç”¨å‘½ä»¤)]
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -- - ï½¥" | lolcat -f -F 0.05
echo "â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -- - ï½¥
â”‚ ä½¿ç”¨æ–¹æ³•: ${0##*/} [command]
â”‚ command(å¯ç”¨å‘½ä»¤):
â”‚  add    / a   æ·»åŠ å½“å‰èƒŒæ™¯åˆ°æ”¶è—
â”‚  remove / rm  åˆ é™¤æ”¶è—
â”‚  list   / l   æ˜¾ç¤ºæ”¶è—åˆ—è¡¨
â”‚  html   / h   ç”ŸæˆHTMLç›¸å†Œ
â”‚  set          è®¾ç½®æŒ‡å®šå›¾ç‰‡ä¸ºèƒŒæ™¯
â”‚  random / r   éšæœºåˆ‡æ¢èƒŒæ™¯
â”‚  locate / lo  åœ¨Finderä¸­å®šä½æ–‡ä»¶
â”‚  search / s   æ¨¡ç³Šæœç´¢å›¾ç‰‡
â”‚  thumb  / t   æ˜¾ç¤ºç¼©ç•¥å›¾
â”‚  rebuild / re é‡å»ºæ”¶è—åˆ—è¡¨(å»é™¤å·²ç»ä¸å­˜åœ¨çš„æ–‡ä»¶)
â”‚  table / ta   è¡¨æ ¼å½¢å¼å±•ç¤ºå›¾ç‰‡
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -- - ï½¥" | lolcat -f -F 0.05
		;;
	esac
}

main "$@"
