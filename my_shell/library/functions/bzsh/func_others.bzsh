### Package Desc: å…¶ä»–è‡ªå®šä¹‰å‘½ä»¤

function fzf_bookmark_list() {                                                  # Desc: function: fzf_bookmark_list: åˆ©ç”¨fzfå®ç°çš„ä¹¦ç­¾
    local ifbreak="${1:-0}"
    builtin cd ${TMP_FZF_BOOKMARKS_PATH}/ 
    local selected=$(ls . | awk -v test="$test" '
            { print }
            END { print "ğŸ”™ è¿”å›" }
			' | fzf $FZF_CUSTOM_PARAMS +m \
    --bind="ctrl-d:execute(rm -f ${TMP_FZF_BOOKMARKS_PATH}/{})+reload(ls .)" \
    --header="$(_buildFzfHeader '' 'fzf_view_bookmarks_list')" \
    --preview-window="right:70%:border-rounded,nohidden,~3" \
    --preview="(${MYRUNTIME}/customs/bin/_previewer ${TMP_FZF_BOOKMARKS_PATH}/{}) 2> /dev/null | head -500")
    builtin cd -
    if [ "" != "${selected}" ] && [ "ğŸ”™ è¿”å›" != "${selected}" ]; then
        head -n 1 ${TMP_FZF_BOOKMARKS_PATH}/${selected} | pbcopy
        return
    fi
    return 1
}
alias fbl="fzf_bookmark_list"                                                   # Desc: alias: fbl: fzf_bookmark_listå‘½ä»¤çš„åˆ«å‘½ï¼Œåˆ©ç”¨fzfå®ç°çš„ä¹¦ç­¾

function bookmark_add() {                                                       # Desc: function: bookmark_add:ä¹¦ç­¾æ·»åŠ 
    local name
    local path
    local desc
    
    local text='è¯·è¾“å…¥ä¹¦ç­¾å '
    $USE_GUM && name=$(gum input --placeholder "$text") || read -rep "$text" name </dev/tty

    # æ£€æŸ¥ä¹¦ç­¾åç§°æ˜¯å¦æœ‰æ•ˆ
    if [[ -z "$name" ]]; then
        echo "é”™è¯¯ï¼šä¹¦ç­¾åç§°ä¸èƒ½ä¸ºç©º"
        return 1
    fi

    text='è¯·è¾“å…¥ä¹¦ç­¾æ–‡ä»¶åœ°å€ '
    $USE_GUM && path=$(gum input --placeholder "$text") || read -rep "$text" path </dev/tty

    text='è¯·è¾“å…¥ä¹¦ç­¾æè¿° '
    $USE_GUM && desc=$(gum input --placeholder "$text") || read -rep "$text" desc </dev/tty

    if [ ! -f ${TMP_FZF_BOOKMARKS_PATH}/${name} ]; then
        # æ·»åŠ æ–°ä¹¦ç­¾
        touch ${TMP_FZF_BOOKMARKS_PATH}/${name}
        echo "${path}" > "${TMP_FZF_BOOKMARKS_PATH}/${name}"
        echo "#Desc:${desc}" >> "${TMP_FZF_BOOKMARKS_PATH}/${name}"
    else
        echo "${path}" > "${TMP_FZF_BOOKMARKS_PATH}/${name}"
        echo "#Desc:${desc}" >> "${TMP_FZF_BOOKMARKS_PATH}/${name}"
    fi
}
alias ba2="bookmark_add"                                                        # Desc: alias: ba2: bookmark_addå‘½ä»¤çš„åˆ«åï¼Œä¹¦ç­¾æ·»åŠ 

function fzf_bookmark_delete() {                                                # Desc: function: fzf_bookmark_delete: åˆ©ç”¨fzfåˆ é™¤ä¹¦ç­¾
    builtin cd ${TMP_FZF_BOOKMARKS_PATH}/ 
    local selected=$(ls . | awk -v process="$processes" '
            { print }
            END { print "ğŸ”™ è¿”å›" }
			' | fzf $FZF_CUSTOM_PARAMS \
    --bind="ctrl-d:execute(rm -f ${TMP_FZF_BOOKMARKS_PATH}/{})+reload(ls .)" \
    --header="$(_buildFzfHeader '' 'fzf_view_bookmarks_list')" \
    --preview-window="right:70%:border-rounded,nohidden,~3" \
    --preview="(${MYRUNTIME}/customs/bin/_previewer ${TMP_FZF_BOOKMARKS_PATH}/{}) 2> /dev/null | head -500")
    builtin cd -
    if [ "" != "${selected}" ] && [ "ğŸ”™ è¿”å›" != "${selected}" ]; then
        rm -f ${selected}
        return
    fi
    return 1
}
alias fbd2="fzf_bookmark_delete"                                                # Desc: alias: fbd2: fzf_bookmark_deleteå‘½ä»¤åˆ«åï¼Œåˆ©ç”¨fzfåˆ é™¤ä¹¦ç­¾

function fzf_bookmark_manager() {                                               # Desc: function: fzf_bookmark_manager: åˆ©ç”¨fzfç®¡ç†ä¹¦ç­¾
    local options=(
        "åˆ—è¡¨"
        "æ·»åŠ "
        "åˆ é™¤"
        "ğŸ”™ è¿”å›"
    )
    
    custom_gum_show2hide_header "ä¹¦ç­¾ç®¡ç†"
    while true; do        
        local selection=$(printf '%s\n' "${options[@]}" | fzf \
            --height=30% \
            --reverse \
            --prompt="â¤ ä¹¦ç­¾ > "
        )
        
        case $selection in
            *åˆ—è¡¨*)
                fzf_bookmark_list
                ;;
            *æ·»åŠ *)
                bookmark_add
                ;;
            *åˆ é™¤*)
                fzf_bookmark_delete
                ;;
            *è¿”å›*|*)
                break
                ;;
        esac
    done
}
alias fbm2="fzf_bookmark_manager"                                               # Desc: alias: fbm2: fzf_bookmark_managerå‘½ä»¤çš„åˆ«åï¼Œåˆ©ç”¨fzfç®¡ç†ä¹¦ç­¾

function fzf_customs_manager() {                                                # Desc: function: fzf_customs_manager: åˆ©ç”¨fzfç®¡ç†è‡ªå®šä¹‰å‘½ä»¤
    local options=(
        "â„¢ï¸ è‡ªå®šä¹‰FZFå‡½æ•°(Fzf Function)"
        "Â®ï¸ è‡ªå®šä¹‰å‡½æ•°(Function)"
        "Â©ï¸ è‡ªå®šä¹‰åˆ«å(Alia)"
        "ğŸ”™ è¿”å›"
    )
    
    custom_gum_show2hide_header "è‡ªå®šä¹‰ç®¡ç†"
    while true; do        
        local selection=$(printf '%s\n' "${options[@]}" | fzf \
            --height=30% \
            --reverse \
            --prompt="â¤ è‡ªå®šä¹‰ > "
        )
        case $selection in
            *è‡ªå®šä¹‰FZFå‡½æ•°*) 
                fzf_customs_fzf_awesome_functions_list ;;
            *è‡ªå®šä¹‰å‡½æ•°*) 
                fzf_search_custom_functions_by_desc ;;
            *è‡ªå®šä¹‰åˆ«å*) 
                fzf_search_custom_alias_by_desc ;;
            *è¿”å›*|*)
                break
                ;;
        esac
    done
}
alias fcm="fzf_customs_manager"                                                 # Desc: alias: fcm: fzf_customs_managerå‘½ä»¤çš„åˆ«å,åˆ©ç”¨fzfç®¡ç†è‡ªå®šä¹‰å‘½ä»¤